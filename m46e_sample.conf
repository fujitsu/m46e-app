################################################################################
# M46Eアプリケーション 設定ファイル サンプル
################################################################################

################################################################################
# 共通設定 (省略不可)
################################################################################
[general]
################################################################################
# Plane名。Stubネットワークの名称として使用する。(省略不可)
# 外部コマンドで指定するアプリケーション名はここで設定した値を使用するので、
# 複数Planeを起動する場合は他と被らない値にすること。
plane_name             = m46e0
################################################################################
# PlaneID。IPv6表記で設定すること。(省略可)
# 省略時のデフォルト値：0:0
plane_id               = 64:1
################################################################################
# M46Eのunicast prefix address。(省略不可)
# IPv6ユニキャストアドレス形式で設定すること。
# tunnel_modeが通常モード(0)の場合はprefix長は最大96まで、
# M46E-ASモード(1)の場合は最大80までとなる。
m46e_unicast_prefix   = 2001:db8:0:46::/64
################################################################################
# M46E-PRの送信元アドレスのunicast prefix address。(省略不可)
# IPv6ユニキャストアドレス形式で設定すること。
# tunnel_modeに関係なくprefix長は最大96まで。
m46e_pr_src_addr_unicast_prefix   = 2001:db8:0:33::/64
################################################################################
# M46Eのmulticast prefix address。(省略不可)
# IPv6マルチキャストアドレス形式で設定すること。
# tunnel_modeが通常モード(0)の場合はprefix長は最大96まで、
# M46E-ASモード(1)の場合は最大80までとなる。
m46e_multicast_prefix = ff01:db8:0:46::/64
################################################################################
# M46Eの動作モード。以下が設定可能 (省略不可)
# ・0：通常モード
# ・1：M46E-ASモード
# ・2：M46E-PRモード
tunnel_mode            = 0
################################################################################
# デバッグログを出力するかどうか (省略可)
#   yes：出力する
#   no ：出力しない (デフォルト)
debug_log              = no
################################################################################
# daemon化(バックグラウンド動作)するかどうか (省略可)
#   yes：daemon化する (デフォルト)
#   no ：daemon化しない
daemon                 = yes
################################################################################
# スタートアップスクリプト (省略可)
# Backbone,Stub各々のネットワーク空間で、メインループ突入前に実行される。
# スクリプトの引数には、Plane名、ネットワーク空間(bb | stub)、トンネルモード、
# unicast plane prefix、multicast plane prefix、トンネルデバイス名が
# この順序で渡される。
#
# 【スクリプト実行例】
#  - Backbone側
#    startup.sh m46e0 bb 0 2001:db8:0:46:64:1:: ff01:db8:0:46:64:1:: m46e0
#  - Stub側
#    startup.sh m46e0 stub 0 2001:db8:0:46:64:1:: ff01:db8:0:46:64:1:: m46e0
#
# ※スクリプトファイルは実行権限のあるファイルをフルパスで指定すること。
startup_script         = /etc/m46e/m46e_startup.sh
################################################################################
# 経路同期をするかどうか（省略可）
# IPv4網の経路表に変更があった場合にIPv6網側の経路表を更新する。
# IPv6網の経路表に変更があった場合にIPv4網側の経路表を更新する。
#   yes：経路同期を行う
#   no ：経路同期を行わない (デフォルト)
# ※M46Eの動作モードがM46E-PRの時は、yesは設定できません。
route_sync  = no
################################################################################
# 経路同期用の経路表に登録できるエントリの最大数 (省略可)
# 設定可能範囲：1～65535
# 省略時のデフォルト値：256
route_entry_max = 256

################################################################################
# M46E-ASモード 専用の設定
# 動作モードがM46E-AS(1)以外の場合はDon't Care(省略可)
#
# M46E-ASモードで動作する場合にIPv6側に設定する経路情報を
# 本セクションの情報を基に設定する。
# (例)
# ◎[tunnel]ipv4_default_gw=noの場合(The Internet側に配置される場合)
#   Backboneネットワーク側の経路情報には
#     ([generic]に設定されているprefix)::0:0:0/80  dev (トンネルデバイス)
#   が設定される。
#   さらに、Stubネットワーク側の経路表に
#     (共有IPアドレス)/32  dev (トンネルデバイス)
#   の経路が設定される。
#
# ◎[tunnel]ipv4_default_gw=yesの場合(データサーバ側に配置される場合)
#     address     = 192.168.1.1
#     start_port  = 1024 (0x400)
#     port_num    = 8
#   と設定されていた場合、Backboneネットワーク側の経路情報には
#     ([generic]に設定されているprefix):c0a8:101:400 / 125
#   が設定される。                      ~~~~~~~~ ~~~   ~~~
#                                       address  port  port_num
#                                                      (8=2^3なので128から3を引く)
################################################################################
[m46e-as]
################################################################################
# 共有するIPアドレス (省略不可)
shared_ipv4_address = 192.168.1.1
################################################################################
# 管理するポートの先頭番号(Locationが1の場合のみ有効) (省略不可)
# ※0～65535の範囲でport_numで割り切れる数値で設定すること。
# ※0以外の数値を設定する場合はport_numよりも大きい値を設定すること。
start_port          = 1024
################################################################################
# 管理するポートの数(Locationが1の場合のみ有効) (省略不可)
# ※2の乗数で設定すること
port_num            = 8


################################################################################
# IPv6網側のPath MTU Discovery関連設定 (省略可)
################################################################################
[pmtud]
################################################################################
# PMTU Discovery動作タイプ。以下が設定可能。(省略可)
# ・0：PMTU Discovery処理を行わない (デフォルト)
# ・1：トンネル毎の情報保持
# ・2：ホスト毎の情報保持
type        = 2
################################################################################
# PMTU長保持期限(秒) (省略可)
# 設定可能範囲：301～65535
# 省略時のデフォルト値：600
expire_time = 600


################################################################################
# トンネルデバイス設定 (省略不可)
################################################################################
[tunnel]
################################################################################
# 生成するトンネルデバイス名 (省略不可)
# ※半角英数字で16文字まで設定可能とする。
tunnel_name     = m46e0
################################################################################
# Stubネットワーク用トンネルデバイスに付与するIPv4アドレス (省略可)
ipv4_address    = 192.168.0.1/24
################################################################################
# Stubネットワーク用トンネルデバイスに設定するMACアドレス (省略可)
# 省略時のデフォルト値：OSが自動設定した値
ipv4_hwaddr     = xx:xx:xx:xx:xx:xx
################################################################################
# Backboneネットワーク用トンネルデバイスに付与するIPv6アドレス (省略可)
ipv6_address    = 2001:db8:a:b:c:d::1/64
################################################################################
# Backboneネットワーク用トンネルデバイスに設定するMACアドレス (省略可)
# 省略時のデフォルト値：OSが自動設定した値
ipv6_hwaddr     = xx:xx:xx:xx:xx:xx
################################################################################
# トンネルデバイスのBackboneネットワーク側のMTUサイズ (省略可)
# 設定可能範囲：1280～65521(※)
# ※ 出口となる物理デバイスのMTU長よりも小さな値を設定した場合、
#    不要なフラグメントを行ったり、正常に通信できなくなったりするので注意すること。
# (Stubネットワーク側のトンネルデバイスはこのサイズ-40(IPv6ヘッダ長)に設定される)
# 省略時のデフォルト値：1500
mtu             = 1500
################################################################################
# Stubネットワーク用のトンネルデバイスをデフォルトゲートウェイにするかどうか。(省略可)
#   yes：デフォルトゲートウェイにする
#   no ：デフォルトゲートウェイにしない (デフォルト)
# ※動作モードがM46E-ASモード(1)の場合には、ホストの配置位置の判定にも
#   使用される。詳細は[M46E-AS]セクションのコメント参照。
ipv4_default_gw = yes

################################################################################
# デバイス設定 (省略可)
################################################################################
[device]
################################################################################
# Stubネットワーク内でのデバイス名 (省略可)
# 省略時のデフォルト値：対応する物理デバイスのデバイス名
name           = eth0
################################################################################
# 対応する物理デバイス名 (省略不可)
physical_dev   = eth0
################################################################################
# デバイスに付与するIPv4アドレス (省略可)
ipv4_address   = 192.168.1.1/24
################################################################################
# デフォルトゲートウェイのアドレス (省略可)
# ※デフォルトゲートウェイはトンネルデバイスを含めた全てのデバイスで
#   一つだけ設定すること。
ipv4_gateway   = 192.168.1.10
################################################################################
# デバイスに設定するMTUサイズ (省略可)
# 省略時のデフォルト値：対応する物理デバイスのMTUサイズ
# ※対応する物理デバイスのMTUサイズより大きな値を設定した場合、
#   MTUサイズが変更できない場合がある。
#   その場合、元のMTUサイズのままで起動する。
mtu            = 1500
################################################################################
# デバイスに設定するMACアドレス (省略可)
# 省略時のデフォルト値：OSが自動設定した値
# ※ハードウェア(デバイスドライバ)の制限により、
#   MACアドレスが変更できない場合がある。
#   その場合、元のMACアドレスのままで起動する。
hwaddr         = xx:xx:xx:xx:xx:xx

# 複数のデバイスを指定する場合には、 [device]セクションを
# 登録するデバイスの数分繰り返し設定する。
# ※デバイス名が重複しないように注意すること。
[device]
name           = eth1
physical_dev   = eth1
ipv4_address   = 192.168.2.1/24
mtu            = 1500
hwaddr         = xx:xx:xx:xx:xx:xx

# 最低限、必要な設定はphysical_devだけなので、
# 下記の設定のみでアプリ起動は可能。
[device]
physical_dev   = eth2

################################################################################
# M46E-PRモード 専用の設定
# 動作モードがM46E-PR(2)以外の場合はDon't Care(省略可)
#
# M46E-PRモードで動作する場合に参照する送信先M46Eアドレスを
# 本セクションの情報を基にM46E-PRテーブルに設定する。
# ※省略時はコマンド登録すること。
#
################################################################################
# 自拠点のM46E-PRエントリー登録 (省略可)
[m46e-pr]
################################################################################
# 自拠点のM46E-PRエントリー(IPv4ネットワークアドレス) (省略可)
ipv4_address    = 192.168.100.0/25
################################################################################
# 自拠点のM46E-PRエントリー(M46E-PR Prefix) (省略可)
m46e_pr_prefix = 2001:db8:0:33::/64
################################################################################
# 他拠点のM46E-PRエントリー登録 (省略可)
[m46e-pr]
################################################################################
# 他拠点のM46E-PRエントリー(IPv4ネットワークアドレス) (省略可)
ipv4_address    = 192.165.0.0/16
################################################################################
# 他拠点のM46E-PRエントリー(M46E-PR Prefix) (省略可)
m46e_pr_prefix = 2001:db8:0:77::/64
################################################################################

# 複数の他拠点のM46E-PRエントリーを登録する場合は、[m46e-pr]セクションを
# 設定するM46E-PRエントリーの数分繰り返し設定する。
# ※組合せが同一のエントリーを登録しないように注意すること。
#   (ネットマスクが異なればOK)

